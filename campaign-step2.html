<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Campaign - Campaign Settings</title>
    <link rel="stylesheet" href="css/sidebar.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .back-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .back-btn:hover {
            background: #f3f4f6;
            border-radius: 8px;
        }
        
        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: #222;
        }
        
        .header-right {
            display: flex;
            gap: 12px;
        }
        
        .save-template-btn {
            background: white;
            border: 1px solid #d1d5db;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .save-template-btn:hover {
            background: #f9fafb;
        }
        
        .next-btn {
            background: #FFD93D;
            border: none;
            padding: 10px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .next-btn:hover {
            background: #ffcf0d;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(255, 217, 61, 0.3);
        }
        
        /* Progress Steps */
        .progress-container {
            background: white;
            padding: 24px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .progress-steps {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 40px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .step {
            display: flex;
            align-items: center;
            gap: 12px;
            color: #9ca3af;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .step.active {
            color: #222;
        }
        
        .step.completed {
            color: #10b981;
        }
        
        .step-circle {
            width: 24px;
            height: 24px;
            border: 2px solid #e5e7eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            transition: all 0.2s;
        }
        
        .step.active .step-circle {
            border-color: #222;
            background: #222;
            color: white;
        }
        
        .step.completed .step-circle {
            border-color: #10b981;
            background: #10b981;
            color: white;
        }
        
        .step.completed .step-circle::before {
            content: "âœ“";
            font-size: 12px;
        }
        
        /* Main Content */
        .main-content {
            max-width: 800px;
            margin: 40px auto;
            padding: 0 24px;
        }
        
        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 24px;
            margin-bottom: 32px;
            padding: 0 32px;
        }
        
        .tab-btn {
            padding: 8px 16px;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .tab-btn.active {
            background: #222;
            color: white;
            border-color: #222;
        }
        
        .tab-btn:hover:not(.active) {
            background: #f9fafb;
        }
        
        /* Form Section */
        .form-section {
            background: white;
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        
        .form-group {
            margin-bottom: 32px;
        }
        
        .form-group:last-child {
            margin-bottom: 0;
        }
        
        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #222;
            margin-bottom: 12px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #8B5CF6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        .input-wrapper {
            position: relative;
        }
        
        .macros-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            padding: 6px 12px;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .macros-btn:hover {
            background: #f9fafb;
        }
        
        .macros-btn::before {
            content: "+";
            margin-right: 4px;
            font-weight: bold;
        }
        
        .preview-text {
            font-size: 13px;
            color: #6b7280;
            margin-top: 8px;
        }
        
        /* Radio Groups */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 14px;
            color: #374151;
        }
        
        .radio-input {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: #FFD93D;
        }
        
        .radio-input:checked {
            accent-color: #FFD93D;
        }
        
        /* Conversions Section Styles */
        .section-heading {
            font-size: 24px;
            font-weight: 600;
            color: #111;
            margin-bottom: 24px;
        }
        
        .radio-option {
            margin-bottom: 20px;
        }
        
        .radio-option input[type="radio"] {
            display: none;
        }
        
        .radio-option .radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 16px;
            color: #111;
        }
        
        .radio-circle {
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            margin-right: 12px;
            position: relative;
            transition: all 0.2s;
        }
        
        .radio-option input[type="radio"]:checked + .radio-label .radio-circle {
            border-color: #fbbf24;
        }
        
        .radio-option input[type="radio"]:checked + .radio-label .radio-circle::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #fbbf24;
        }
        
        .dropdown-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-left: 32px;
        }
        
        /* Select Dropdown */
        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5 7.5L10 12.5L15 7.5' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 40px;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #8B5CF6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        /* Toggle Switch */
        .toggle-section {
            padding: 24px 32px;
            background: #f9fafb;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .toggle-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .toggle-row:last-child {
            margin-bottom: 0;
        }
        
        .toggle-content {
            flex: 1;
            margin-right: 20px;
        }
        
        .toggle-title {
            font-size: 15px;
            font-weight: 600;
            color: #222;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-icon {
            width: 16px;
            height: 16px;
            background: #d1d5db;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            color: #6b7280;
            cursor: help;
        }
        
        .toggle-description {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.5;
        }
        
        .learn-more {
            color: #8B5CF6;
            text-decoration: none;
            font-weight: 500;
        }
        
        .learn-more:hover {
            text-decoration: underline;
        }
        
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #d1d5db;
            transition: .3s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #10b981;
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .notification-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: #ef4444;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
            vertical-align: super;
        }
    </style>
</head>
<body>
    <div class="dashboard-layout">
        <!-- Sidebar will be injected here by JavaScript -->
        <div class="main-wrapper">
            <!-- Header -->
            <div class="header">
        <div class="header-left">
            <h1 class="page-title">New campaign</h1>
        </div>
        <div class="header-right">
            <button class="save-template-btn">Save template</button>
            <button class="next-btn" onclick="nextStep()">Next</button>
        </div>
    </div>
    
    <!-- Progress Steps -->
    <div class="progress-container">
        <div class="progress-steps">
            <div class="step completed" data-step="upload">
                <span class="step-circle"></span>
                <span>Upload</span>
            </div>
            <div class="step active" data-step="campaign">
                <span class="step-circle"></span>
                <span>Campaign</span>
            </div>
            <div class="step" data-step="adsets">
                <span class="step-circle"></span>
                <span>Ad sets</span>
            </div>
            <div class="step" data-step="ads">
                <span class="step-circle"></span>
                <span>Ads</span>
            </div>
            <div class="step" data-step="review">
                <span class="step-circle"></span>
                <span>Review</span>
            </div>
        </div>
    </div>
    
    <!-- Tab Navigation -->
    <div class="main-content">
        <div class="tab-nav">
            <button class="tab-btn active">Create new campaign</button>
            <button class="tab-btn">Use existing campaign</button>
        </div>
        
        <!-- Campaign Name Section -->
        <div class="form-section">
            <div class="form-group">
                <label class="form-label">Campaign name</label>
                <div class="input-wrapper">
                    <input type="text" class="form-input" placeholder="New campaign" value="New campaign" style="padding-right: 100px;">
                    <button class="macros-btn">Macros</button>
                </div>
                <p class="preview-text">Preview: New campaign</p>
            </div>
        </div>
        
        <!-- Campaign Objective Section -->
        <div class="form-section">
            <div class="form-group">
                <label class="form-label">Campaign objective</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input">
                        Awareness
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input">
                        Engagement
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input">
                        Leads
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input">
                        Sales
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input">
                        Traffic
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="objective" class="radio-input" checked>
                        App promotion
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Conversions Section -->
        <div class="form-section">
            <h2 class="section-heading">Conversions</h2>
            
            <div class="form-group">
                <label class="form-label">Conversion location</label>
                
                <div class="radio-option">
                    <input type="radio" id="conversionWebsite" name="conversionLocation">
                    <label for="conversionWebsite" class="radio-label">
                        <span class="radio-circle"></span>
                        <span>Website</span>
                    </label>
                </div>
                
                <div class="radio-option">
                    <input type="radio" id="conversionApp" name="conversionLocation" checked>
                    <label for="conversionApp" class="radio-label">
                        <span class="radio-circle"></span>
                        <span>App</span>
                    </label>
                </div>
                
                <div class="radio-option">
                    <input type="radio" id="conversionMessenger" name="conversionLocation">
                    <label for="conversionMessenger" class="radio-label">
                        <span class="radio-circle"></span>
                        <span>Messenger</span>
                    </label>
                </div>
                
                <div class="radio-option">
                    <input type="radio" id="conversionWhatsApp" name="conversionLocation">
                    <label for="conversionWhatsApp" class="radio-label">
                        <span class="radio-circle"></span>
                        <span>WhatsApp</span>
                    </label>
                </div>
                
                <div class="radio-option">
                    <input type="radio" id="conversionCalls" name="conversionLocation">
                    <label for="conversionCalls" class="radio-label">
                        <span class="radio-circle"></span>
                        <span>Calls</span>
                    </label>
                </div>
                
                <div id="conversionDropdowns" class="dropdown-group">
                    <!-- Dropdowns will be dynamically inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Special Ad Categories -->
        <div class="toggle-section">
            <div class="toggle-row">
                <div class="toggle-content">
                    <div class="toggle-title">
                        Special ad categories
                        <span class="info-icon">?</span>
                    </div>
                    <div class="toggle-description">
                        You're required to declare if your ads are related to financial products and services, employment or housing opportunities, or related to social issues, elections or politics. 
                        <a href="#" class="learn-more">Learn more â†—</a>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="specialCategoriesToggle">
                    <span class="slider"></span>
                </label>
            </div>
            
            <!-- Additional fields shown when toggle is enabled -->
            <div id="specialCategoriesFields" style="display: none; margin-top: 24px; padding-top: 24px; border-top: 1px solid #e5e7eb;">
                <div class="form-group">
                    <label class="form-label">Categories</label>
                    <select class="form-select" id="specialCategory">
                        <option value="">Select a category</option>
                        <option value="credit">Credit</option>
                        <option value="employment">Employment</option>
                        <option value="housing">Housing</option>
                        <option value="social_issues">Social issues, elections or politics</option>
                    </select>
                </div>
                
                <div class="form-group" style="margin-top: 16px;">
                    <label class="form-label">Countries</label>
                    <select class="form-select" id="specialCategoryCountries" multiple style="height: 120px;">
                        <option value="US" selected>United States</option>
                        <option value="CA">Canada</option>
                        <option value="GB">United Kingdom</option>
                        <option value="AU">Australia</option>
                        <option value="FR">France</option>
                        <option value="DE">Germany</option>
                        <option value="IT">Italy</option>
                        <option value="ES">Spain</option>
                        <option value="BR">Brazil</option>
                        <option value="MX">Mexico</option>
                    </select>
                    <p class="form-description" style="margin-top: 8px; font-size: 12px; color: #6b7280;">
                        Hold Ctrl/Cmd to select multiple countries
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Advantage Campaign Budget -->
        <div class="toggle-section">
            <div class="toggle-row">
                <div class="toggle-content">
                    <div class="toggle-title">
                        Advantage campaign budget
                        <span class="notification-badge">1</span>
                    </div>
                    <div class="toggle-description">
                        Campaign budget optimisation will distribute your budget across ad sets to get more results depending on your delivery optimisation choices and bid strategy. You can control spending on each ad set. 
                        <a href="#" class="learn-more">Learn more â†—</a>
                    </div>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox">
                    <span class="slider"></span>
                </label>
            </div>
        </div>
    </div>
    
    <script>
        // Sidebar toggle functionality
        function toggleSidebar() {
            const sidebar = document.getElementById('campaignSidebar');
            const toggle = document.getElementById('sidebarToggle');
            const overlay = document.getElementById('sidebarOverlay');
            const body = document.body;
            
            sidebar.classList.toggle('open');
            toggle.classList.toggle('open');
            
            if (sidebar.classList.contains('open')) {
                overlay.classList.add('show');
                body.classList.add('sidebar-open');
            } else {
                overlay.classList.remove('show');
                body.classList.remove('sidebar-open');
            }
        }
        
        // Select objective from sidebar
        function selectObjective(type) {
            // Update radio buttons
            const radios = document.querySelectorAll('input[name="objective"]');
            radios.forEach(radio => {
                const label = radio.parentElement.textContent.trim().toLowerCase();
                if (label.includes(type.toLowerCase()) || 
                    (type === 'app' && label.includes('app promotion'))) {
                    radio.checked = true;
                    
                    // Trigger change event
                    const event = new Event('change');
                    radio.dispatchEvent(event);
                }
            });
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget?.classList.add('active');
            
            // Update conversion options
            updateConversionOptions();
        }
        
        // Quick action functions
        function loadTemplate() {
            alert('Template library coming soon! You can save and load campaign templates here.');
        }
        
        function duplicateCampaign() {
            alert('Select a campaign to duplicate its settings.');
        }
        
        function importSettings() {
            alert('Import campaign settings from a JSON file.');
        }
        
        function exportSettings() {
            // Collect current settings
            const settings = {
                campaignName: document.querySelector('input[placeholder="New campaign"]')?.value,
                objective: document.querySelector('input[name="objective"]:checked')?.parentElement.textContent.trim(),
                conversionLocation: document.querySelector('input[name="conversionLocation"]:checked')?.nextElementSibling.querySelector('span:last-child').textContent,
                specialCategories: document.getElementById('specialCategoriesToggle')?.checked,
                advantageBudget: document.querySelector('.toggle-section:last-child input[type="checkbox"]')?.checked
            };
            
            // Download as JSON
            const dataStr = JSON.stringify(settings, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            const exportFileDefaultName = 'campaign-settings.json';
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }
        
        function loadCampaign(campaignId) {
            console.log('Loading campaign:', campaignId);
            // Here you would load campaign data from backend
            alert(`Loading campaign ${campaignId} settings...`);
        }
        
        function openHelp(topic) {
            const helpContent = {
                objectives: 'Campaign objectives determine how your ads are optimized. Choose based on your business goals.',
                budget: 'Set daily or lifetime budgets. Use Advantage campaign budget for automatic optimization.',
                compliance: 'EU Digital Services Act requires transparency in political and issue ads.'
            };
            
            alert(helpContent[topic] || 'Help documentation coming soon.');
        }
        
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // Step navigation
        function nextStep() {
            window.location.href = 'campaign-step3.html';
        }
        
        // Step click navigation
        document.querySelectorAll('.step').forEach(step => {
            step.addEventListener('click', function() {
                const stepName = this.dataset.step;
                if (stepName === 'upload') {
                    window.location.href = 'new-campaign.html';
                }
            });
        });
        
        // Dynamic Conversion Options Based on Campaign Objective
        const conversionOptions = {
            'Awareness': {
                'Website': [
                    { value: 'page_view', text: 'Maximize page views' },
                    { value: 'landing_page', text: 'Landing page visits' },
                    { value: 'unique_visitors', text: 'Unique visitors' }
                ],
                'App': [
                    { value: 'app_impressions', text: 'App impressions' },
                    { value: 'app_opens', text: 'App opens' }
                ],
                'Messenger': [
                    { value: 'message_impressions', text: 'Message impressions' }
                ]
            },
            'Engagement': {
                'Website': [
                    { value: 'post_engagement', text: 'Post engagement' },
                    { value: 'page_likes', text: 'Page likes' },
                    { value: 'comments', text: 'Comments' },
                    { value: 'shares', text: 'Shares' }
                ],
                'App': [
                    { value: 'app_engagement', text: 'App engagement' },
                    { value: 'in_app_actions', text: 'In-app actions' }
                ],
                'Messenger': [
                    { value: 'conversations', text: 'Conversation starts' },
                    { value: 'replies', text: 'Message replies' }
                ]
            },
            'Leads': {
                'Website': [
                    { value: 'lead_form', text: 'Lead form submissions' },
                    { value: 'instant_form', text: 'Instant forms' },
                    { value: 'contact_form', text: 'Contact forms' },
                    { value: 'signup', text: 'Sign-ups' }
                ],
                'App': [
                    { value: 'app_registration', text: 'App registrations' },
                    { value: 'app_lead', text: 'App leads' }
                ],
                'Messenger': [
                    { value: 'messenger_lead', text: 'Messenger leads' },
                    { value: 'qualified_lead', text: 'Qualified leads' }
                ],
                'WhatsApp': [
                    { value: 'whatsapp_lead', text: 'WhatsApp leads' },
                    { value: 'whatsapp_form', text: 'WhatsApp forms' }
                ],
                'Calls': [
                    { value: 'call_lead', text: 'Call leads' },
                    { value: 'callback_request', text: 'Callback requests' }
                ]
            },
            'Sales': {
                'Website': [
                    { value: 'purchase', text: 'Purchases' },
                    { value: 'add_to_cart', text: 'Add to cart' },
                    { value: 'checkout', text: 'Checkouts' },
                    { value: 'payment_info', text: 'Add payment info' },
                    { value: 'value_optimization', text: 'Value optimization' }
                ],
                'App': [
                    { value: 'app_purchase', text: 'App purchases' },
                    { value: 'in_app_purchase', text: 'In-app purchases' },
                    { value: 'subscription', text: 'Subscriptions' }
                ],
                'WhatsApp': [
                    { value: 'whatsapp_purchase', text: 'WhatsApp purchases' },
                    { value: 'catalog_sales', text: 'Catalog sales' }
                ]
            },
            'Traffic': {
                'Website': [
                    { value: 'link_clicks', text: 'Link clicks' },
                    { value: 'landing_page_views', text: 'Landing page views' },
                    { value: 'daily_unique_reach', text: 'Daily unique reach' }
                ],
                'App': [
                    { value: 'app_installs', text: 'App installs' },
                    { value: 'app_events', text: 'App events' }
                ],
                'Messenger': [
                    { value: 'messenger_clicks', text: 'Messenger clicks' },
                    { value: 'conversation_starts', text: 'Conversation starts' }
                ],
                'WhatsApp': [
                    { value: 'whatsapp_clicks', text: 'WhatsApp clicks' }
                ],
                'Calls': [
                    { value: 'call_clicks', text: 'Call clicks' }
                ]
            },
            'App promotion': {
                'App': [
                    { value: 'app_installs', text: 'App installs' },
                    { value: 'app_events', text: 'App events' },
                    { value: 'app_registrations', text: 'Registrations' },
                    { value: 'app_purchases', text: 'Purchases' },
                    { value: 'app_engagement', text: 'Engagement' },
                    { value: 'value_optimization', text: 'Value optimization' }
                ]
            }
        };
        
        // Update conversion options when objective changes
        function updateConversionOptions() {
            const selectedObjective = document.querySelector('input[name="objective"]:checked');
            const conversionDropdowns = document.getElementById('conversionDropdowns');
            const conversionLocationInputs = document.querySelectorAll('input[name="conversionLocation"]');
            
            if (!selectedObjective) return;
            
            const objectiveText = selectedObjective.parentElement.textContent.trim();
            const availableLocations = Object.keys(conversionOptions[objectiveText] || {});
            
            // Hide/show conversion locations based on objective
            conversionLocationInputs.forEach(input => {
                const locationLabel = input.nextElementSibling.querySelector('span:last-child').textContent;
                const radioOption = input.closest('.radio-option');
                
                if (availableLocations.includes(locationLabel)) {
                    radioOption.style.display = 'block';
                } else {
                    radioOption.style.display = 'none';
                    if (input.checked) {
                        input.checked = false;
                    }
                }
            });
            
            // Auto-select first available location if none selected
            const visibleInputs = Array.from(conversionLocationInputs).filter(input => 
                input.closest('.radio-option').style.display !== 'none'
            );
            
            if (visibleInputs.length > 0 && !Array.from(conversionLocationInputs).some(input => input.checked)) {
                visibleInputs[0].checked = true;
            }
            
            // Update dropdowns based on selected location
            updateConversionDropdowns();
        }
        
        // Update dropdowns based on selected conversion location
        function updateConversionDropdowns() {
            const selectedObjective = document.querySelector('input[name="objective"]:checked');
            const selectedLocation = document.querySelector('input[name="conversionLocation"]:checked');
            const conversionDropdowns = document.getElementById('conversionDropdowns');
            
            if (!selectedObjective || !selectedLocation) {
                conversionDropdowns.innerHTML = '';
                return;
            }
            
            const objectiveText = selectedObjective.parentElement.textContent.trim();
            const locationText = selectedLocation.nextElementSibling.querySelector('span:last-child').textContent;
            
            const options = conversionOptions[objectiveText]?.[locationText] || [];
            
            if (options.length === 0) {
                conversionDropdowns.innerHTML = '';
                return;
            }
            
            // Create dropdown HTML
            let dropdownHTML = `
                <div class="form-group" style="margin-top: 20px;">
                    <label class="form-label">Conversion goal</label>
                    <select class="form-select" id="conversionGoal">
            `;
            
            options.forEach(option => {
                dropdownHTML += `<option value="${option.value}">${option.text}</option>`;
            });
            
            dropdownHTML += `
                    </select>
                </div>
            `;
            
            // Add additional dropdowns based on objective
            if (objectiveText === 'Sales' && locationText === 'Website') {
                dropdownHTML += `
                    <div class="form-group">
                        <label class="form-label">Product catalog</label>
                        <select class="form-select" id="productCatalog">
                            <option value="none">No catalog</option>
                            <option value="catalog1">Main catalog</option>
                            <option value="catalog2">Promo catalog</option>
                            <option value="create_new">+ Create new catalog</option>
                        </select>
                    </div>
                `;
            }
            
            if (objectiveText === 'App promotion') {
                dropdownHTML += `
                    <div class="form-group">
                        <label class="form-label">Application</label>
                        <select class="form-select" id="appSelect">
                            <option value="app1">MyApp iOS</option>
                            <option value="app2">MyApp Android</option>
                            <option value="add_new">+ Add application</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Optimization events</label>
                        <select class="form-select" id="appEvents">
                            <option value="install">Install</option>
                            <option value="registration">Registration</option>
                            <option value="purchase">Purchase</option>
                            <option value="custom">Custom event</option>
                        </select>
                    </div>
                `;
            }
            
            if (locationText === 'Website' && (objectiveText === 'Leads' || objectiveText === 'Sales')) {
                dropdownHTML += `
                    <div class="form-group">
                        <label class="form-label">Pixel</label>
                        <select class="form-select" id="pixelSelect">
                            <option value="pixel1">Facebook Pixel #12345</option>
                            <option value="pixel2">Facebook Pixel #67890</option>
                            <option value="create_pixel">+ Create pixel</option>
                        </select>
                    </div>
                `;
            }
            
            conversionDropdowns.innerHTML = dropdownHTML;
        }
        
        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Listen for objective changes
            document.querySelectorAll('input[name="objective"]').forEach(input => {
                input.addEventListener('change', updateConversionOptions);
            });
            
            // Listen for conversion location changes
            document.querySelectorAll('input[name="conversionLocation"]').forEach(input => {
                input.addEventListener('change', updateConversionDropdowns);
            });
            
            // Special ad categories toggle functionality
            const specialCategoriesToggle = document.getElementById('specialCategoriesToggle');
            const specialCategoriesFields = document.getElementById('specialCategoriesFields');
            
            if (specialCategoriesToggle && specialCategoriesFields) {
                specialCategoriesToggle.addEventListener('change', function() {
                    if (this.checked) {
                        specialCategoriesFields.style.display = 'block';
                        // Smooth animation
                        specialCategoriesFields.style.opacity = '0';
                        setTimeout(() => {
                            specialCategoriesFields.style.transition = 'opacity 0.3s ease';
                            specialCategoriesFields.style.opacity = '1';
                        }, 10);
                    } else {
                        specialCategoriesFields.style.transition = 'opacity 0.3s ease';
                        specialCategoriesFields.style.opacity = '0';
                        setTimeout(() => {
                            specialCategoriesFields.style.display = 'none';
                        }, 300);
                    }
                });
            }
            
            // Advantage campaign budget toggle functionality
            const advantageBudgetToggle = document.querySelector('.toggle-section:last-child input[type="checkbox"]');
            if (advantageBudgetToggle) {
                advantageBudgetToggle.addEventListener('change', function() {
                    if (this.checked) {
                        // Here you could add additional fields or functionality for campaign budget optimization
                        console.log('Advantage campaign budget enabled');
                    } else {
                        console.log('Advantage campaign budget disabled');
                    }
                });
            }
            
            // Initialize on load
            updateConversionOptions();
        });
    </script>
    
    <!-- Core JavaScript Libraries -->
    <script src="js/storage.js"></script>
    <script src="js/data.js"></script>
    <script src="js/app.js"></script>
    <script src="js/campaign-wizard.js"></script>
    <script src="js/sidebar.js"></script>
        </div>
    </div>
</body>
</html>